
## 교착상태(Deadlock)

> 교착 상태란 여러 프로세스 또는 스레드가 서로 다른 프로세스가 보유한 자원을 요구하면서 무한정 대기하는 상태를 말한다. 이 상태에서는 어떤 프로세스도 자신이 필요로 하는 자원을 얻을 수 없으며, 결과적으로 모든 프로세스의 실행이 멈춘다.

교착 상태는 특히 멀티프로세싱 시스템이나 멀티스레딩 환경에서 발생할 수 있는데, 이는 여러 프로세스나 스레드가 동시에 자원을 사용하려고 할 때 서로의 자원을 기다리게 되어 발생한다. 예를 들어, 두 프로세스가 서로 다른 자원을 각각 보유하고 있으면서, 동시에 상대방의 자원을 요구하는 상황에서 교착 상태가 발생할 수 있다.

교착 상태를 해결하기 위해서는 일반적으로 프로세스를 중단하거나, 자원 할당을 취소하는 등의 조치가 필요하다. 시스템 설계 단계에서 교착 상태의 가능성을 최소화하기 위한 다양한 기법들이 적용될 수 있다.

### 교착상태의 발생 조건

1. **상호 배제(Mutual Exclusion)** 
<br>자원은 한 번에 한 프로세스만이 사용할 수 있어야 한다. 다른 프로세스는 그 자원이 해제될 때까지 기다려야 한다.


2. **보유 및 대기(Hold and Wait)** 
<br>프로세스가 어떤 자원을 보유하고 있는 상태에서 다른 자원을 대기하는 상황이 발생해야 한다. 즉, 프로세스가 이미 할당받은 자원을 가지고 있으면서 동시에 다른 자원을 요청하고 기다리는 경우를 말한다.


3. **비선점(No Preemption)** 
<br>한 프로세스가 다른 프로세스로부터 자원을 강제로 빼앗을 수 없는 조건이어야 한다. 즉, 자원은 그것을 보유하고 있는 프로세스가 자발적으로 해제할 때까지 다른 프로세스가 사용할 수 없다.


4. **순환 대기(Circular Wait)** 
<br>프로세스의 집합에서 각 프로세스는 다음 프로세스가 요청한 자원을 보유하고 있어야 한다. 이러한 형태는 순환 구조를 형성하여, 각 프로세스는 순환적으로 다음 프로세스가 필요로 하는 자원을 가지고 있어야 한다.


### 해결방법

1. **교착 상태 예방(Deadlock Prevention)** <br><br>
   - 교착 상태가 발생하지 않도록 시스템을 설계하는 방법이다.
   - 상호 배제, 보유 및 대기, 비선점, 순환 대기 등 교착 상태 발생에 필요한 조건 중 하나 이상을 제거함으로써 교착 상태를 예방한다.
   - 예를 들어, 자원을 한 번에 모두 요청하게 하거나, 프로세스가 다른 자원을 요구할 때 이미 보유한 자원을 해제하도록 하는 방식이 있다.
   - 교착 상태가 발생할 여지를 원천적으로 차단하지만 자원 활용도가 낮아질 수 있고, 프로세스 실행 효율이 감소할 수 있다. 예를 들어, 상호 배제를 완화하기 어려운 경우 자원이 낭비될 수 있다.
   <br><br>
2. **교착 상태 회피(Deadlock Avoidance)** <br><br>
   - 시스템이 자원을 할당할 때 교착 상태 발생 가능성을 고려하여 안전하게 자원을 할당하는 방법이다.
   - '은행원 알고리즘'과 같은 방법을 사용하여, 시스템이 교착 상태에 빠지지 않을 안전한 상태로만 자원을 할당한다.
   - 이 방법은 시스템의 현재 상태와 가능한 모든 자원 요청을 고려하여 결정을 내린다. 
   - 이 방법을 통해 시스템이 교착 상태에 빠지는 것을 피하면서도 자원을 효율적으로 사용할 수 있다. <br>그러나, 자원 요청과 시스템 상태를 지속적으로 모니터링해야 하므로 **관리가 복잡**하다. 또한, 시스템의 전체 성능에 영향을 미칠 수 있다.
   <br><br>
3. **교착 상태 탐지 및 복구(Deadlock Detection and Recovery)** <br><br>
   - 교착상태가 발생하도록 놔두되, 시스템이 주기적으로 교착 상태를 탐지하고 발견하면 적절한 조치를 취하여 복구하는 방법이다.
   - 교착 상태 탐지는 자원 할당 그래프를 분석하는 방법으로 수행된다.
   - 복구는 보통 프로세스를 종료하거나 일부 자원을 선점하여 다른 프로세스에게 재할당하는 방식으로 이루어진다.
   - 교착 상태를 실시간으로 탐지하고, 필요에 따라 복구할 수 있다.<br> 그러나, 교착 상태 탐지 알고리즘이 자원을 소모하며, 복구 과정에서 작업 손실이 발생할 수 있다. 특히, 프로세스를 강제 종료할 경우 중요한 작업이 손실될 위험이 있다.
   - 교착 상태를 예방하거나 처리하는데에 큰 비용이 드는데 비해 실제로 교착상태가 발생하는 빈도는 매우 낮기 때문에, 오히려 예방 및 처리 비용을 아끼고 교착상태를 내버려두는 것이 훨씬 효율적이다.
   <br><br>
4. **자원의 선점 및 재할당(Preemption and Reassignment)** <br><br>
   - 교착 상태에 빠진 프로세스로부터 자원을 강제로 회수하고 다른 프로세스에게 재할당하는 방법이다. (프로세스를 종료하지 않는다.)
   - 이 방법은 프로세스의 상태를 저장하고 나중에 복구할 수 있어야 한다.
    - 선점은 프로세스에게 큰 영향을 미칠 수 있으므로 신중하게 사용해야 한다.