## ARP (Address Resolution Protocol)

### 1. ARP란?
> ARP(Address Resolution Protocol)는 **IP 주소를 MAC 주소로 변환하는 프로토콜**이다.  
네트워크에서 **IP 주소만으로는 패킷을 전송할 수 없기 때문에** 해당 IP 주소에 대응하는 **물리적 주소(MAC 주소)** 를 알아내야 한다.  
이때 사용되는 프로토콜이 **ARP**다.

---

### 2. ARP 동작 방식
1. **ARP 요청 (Request) 전송**
    - 송신자가 목적지의 **IP 주소는 알고 있지만 MAC 주소를 모를 때**, 네트워크에 **"이 IP를 가진 장치의 MAC 주소를 알려줘!"** 라는 요청(브로드캐스트)을 보냄.

2. **ARP 응답 (Reply) 수신**
    - 해당 IP를 가진 장치가 자신의 **MAC 주소를 포함한 응답(유니캐스트)** 을 보냄.
    - 송신자는 이 MAC 주소를 **ARP 캐시(테이블)** 에 저장하여 이후에 같은 IP로 요청할 때 다시 ARP 요청을 하지 않도록 함.

---

### 3. ARP 요청/응답 과정 예시
예를 들어, **192.168.1.10**(A 컴퓨터)이 **192.168.1.20**(B 컴퓨터)에게 데이터를 보내려는 상황:
1. A는 자신의 ARP 캐시에 **192.168.1.20의 MAC 주소가 있는지 확인**
    - 없다면 ARP 요청을 네트워크 전체에 브로드캐스트(`FF:FF:FF:FF:FF:FF`) 전송
2. B는 **"192.168.1.20은 나야!"** 라고 응답(유니캐스트)
    - 자신의 MAC 주소를 포함하여 A에게 전송
3. A는 받은 MAC 주소를 ARP 테이블에 저장하고 B에게 패킷을 전송

---

### 4. ARP 캐시 (ARP Table)
- ARP는 **같은 네트워크에서 자주 사용하는 MAC 주소를 저장**하여 불필요한 ARP 요청을 줄인다.
- `arp -a` 명령어를 통해 현재 ARP 테이블을 확인할 수 있다.

**예시 (Windows/Linux에서 `arp -a` 실행 결과)**:

```
192.168.1.1    00-1a-2b-3c-4d-5e    dynamic
192.168.1.20   11-22-33-44-55-66    dynamic
```

- **동적(Dynamic)**: ARP 요청을 통해 자동 저장된 MAC 주소 (일정 시간이 지나면 삭제됨)
- **정적(Static)**: 수동으로 추가된 MAC 주소 (수동 삭제 전까지 유지)

---

### 5. ARP의 유형
| 유형 | 설명 |
|------|------|
| **일반 ARP** | 가장 기본적인 ARP 요청/응답 |
| **그라티우터스(Gratuitous) ARP** | 자신의 MAC 주소를 네트워크에 알리기 위해 사용 (중복 IP 감지, 네트워크 구성 변경 등) |
| **리버스 ARP (RARP)** | MAC 주소를 통해 IP 주소를 알아내는 방식 (현재는 거의 사용되지 않음) |
| **프록시 ARP** | 라우터가 다른 네트워크의 MAC 주소를 대신 응답하여 브리징 역할 수행 |

---

### 6. ARP의 문제점과 보안 이슈
⚠️ **ARP 스푸핑(ARP Spoofing)**
- 악의적인 공격자가 **위조된 ARP 응답을 보내서** 특정 IP 주소의 MAC 주소를 공격자의 MAC으로 속이는 공격.
- 이를 통해 **중간자 공격(MITM, Man-In-The-Middle)** 을 수행할 수 있음.
- **대응 방법**: 정적 ARP 테이블 사용, ARP 감시(Snooping), 동적 ARP 검사(Dynamic ARP Inspection, DAI)


---

### 7. 정리
✅ ARP는 **IP 주소 → MAC 주소 변환**을 담당하는 필수 네트워크 프로토콜  
✅ 동일 네트워크 내에서만 동작 (라우터를 넘어가면 동작 X)  
✅ ARP 캐시를 사용하여 성능 최적화  
✅ 보안 문제(ARP 스푸핑)에 대비해야 함  